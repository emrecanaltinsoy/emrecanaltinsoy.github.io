---
layout: default
---

{{ content }}

{%- if site.posts.size > 0 -%}
{%- assign all_tags = "" | split: "" -%}
{%- for post in site.posts -%}
  {%- unless post.hidden -%}
    {%- if post.draft -%}
      {%- unless all_tags contains "draft" -%}
        {%- assign all_tags = all_tags | push: "draft" -%}
      {%- endunless -%}
    {%- endif -%}
    {%- if post.tags -%}
      {%- for tag in post.tags -%}
        {%- assign tag_lower = tag | downcase | strip -%}
        {%- unless all_tags contains tag_lower -%}
          {%- assign all_tags = all_tags | push: tag_lower -%}
        {%- endunless -%}
      {%- endfor -%}
    {%- endif -%}
  {%- endunless -%}
{%- endfor -%}
{%- assign all_tags = all_tags | sort -%}

{%- if all_tags.size > 0 -%}
<div class="tag-filter">
  <span class="tag-label">Tags:</span>
  <button class="tag-btn active" data-tag="all">all</button>
  {%- for tag in all_tags -%}
  <button class="tag-btn" data-tag="{{ tag }}">{{ tag }}</button>
  {%- endfor -%}
</div>
{%- endif -%}

<ul class="post-list">
  {%- for post in site.posts -%}
  {%- unless post.hidden -%}
    {%- assign unique_tags = "" | split: "" -%}
  {%- if post.draft -%}
    {%- assign unique_tags = unique_tags | push: "draft" -%}
  {%- endif -%}
  {%- for tag in post.tags -%}
    {%- assign tag_lower = tag | downcase | strip -%}
    {%- unless unique_tags contains tag_lower -%}
      {%- assign unique_tags = unique_tags | push: tag_lower -%}
    {%- endunless -%}
  {%- endfor -%}
  <li data-tags="{{ unique_tags | join: ',' }}">
    {%- assign date_format = "%d %b %Y" -%}
    [ {{ post.date | date: date_format }} ]
    <a href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
    {%- if post.tags.size > 0 or post.draft -%}
    {%- assign post_tags = "" | split: "" -%}
    {%- if post.draft -%}
      {%- assign post_tags = post_tags | push: "draft" -%}
    {%- endif -%}
    {%- for tag in post.tags -%}
      {%- assign tag_lower = tag | downcase | strip -%}
      {%- unless post_tags contains tag_lower -%}
        {%- assign post_tags = post_tags | push: tag_lower -%}
      {%- endunless -%}
    {%- endfor -%}
    <span class="post-tags">
      {%- for tag in post_tags -%}
      <span class="post-tag{% if tag == 'draft' %} post-tag-draft{% endif %}">{{ tag }}</span>
      {%- endfor -%}
    </span>
    {%- endif -%}
  </li>
  {%- endunless -%}
  {%- endfor -%}
</ul>
{%- endif -%}

<script>
(function() {
  var buttons = document.querySelectorAll('.tag-btn');
  var posts = document.querySelectorAll('.post-list li');
  var allBtn = document.querySelector('.tag-btn[data-tag="all"]');
  var selectedTags = [];

  function updatePosts() {
    posts.forEach(function(post) {
      var postTags = post.getAttribute('data-tags').split(',').map(function(t) { return t.trim(); });
      if (selectedTags.length === 0) {
        post.style.display = '';
      } else {
        var hasMatch = selectedTags.some(function(tag) {
          return postTags.includes(tag);
        });
        post.style.display = hasMatch ? '' : 'none';
      }
    });
  }

  allBtn.addEventListener('click', function() {
    selectedTags = [];
    buttons.forEach(function(b) { b.classList.remove('active'); });
    allBtn.classList.add('active');
    updatePosts();
  });

  buttons.forEach(function(btn) {
    if (btn === allBtn) return;

    btn.addEventListener('click', function() {
      var tag = this.getAttribute('data-tag');

      allBtn.classList.remove('active');

      if (selectedTags.includes(tag)) {
        selectedTags = selectedTags.filter(function(t) { return t !== tag; });
        this.classList.remove('active');
      } else {
        selectedTags.push(tag);
        this.classList.add('active');
      }

      if (selectedTags.length === 0) {
        allBtn.classList.add('active');
      }

      updatePosts();
    });
  });
})();
</script>
